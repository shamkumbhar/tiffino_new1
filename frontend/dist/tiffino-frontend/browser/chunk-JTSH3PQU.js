import{a as H}from"./chunk-HHIOAWEY.js";import{a as B}from"./chunk-NP6LRZ72.js";import{b as F,c as u,d as K,e as V,g as R,j as q,m as D,t as G,v as U}from"./chunk-D6ITGMSC.js";import{P as j,b as T,ba as v,ca as z,va as N}from"./chunk-XSLPIIJB.js";import{B as _,Eb as a,Fb as L,Nb as I,R as b,Sa as s,Ta as p,U as w,Z as C,ea as y,hb as c,lb as l,oa as S,pa as k,pb as i,q as x,qa as M,qb as n,qc as A,ra as E,rb as d,sc as O,ub as P,wb as h,xb as g}from"./chunk-IJRFTPMA.js";var J=(()=>{class t{constructor(e){this.http=e,this.adminKey="adminUser",this.tokenKey="adminToken",this.adminLoginUrl=B.adminLogin}adminLogin(e){return this.http.post(this.adminLoginUrl,e).pipe(b({next:o=>{let r=o.user,f=o.token;if(console.log("Admin login response:",o),r.role?.toUpperCase()!=="ADMIN")throw new Error("Not an admin account");this.setAdminToLocalStorage(r),this.setAdminToken(f)},error:o=>{console.error("Admin login failed:",o.error||o)}}),_(o=>x(()=>o)))}setAdminToLocalStorage(e){localStorage.setItem(this.adminKey,JSON.stringify(e))}setAdminToken(e){localStorage.setItem(this.tokenKey,e)}getAdminFromLocalStorage(){let e=localStorage.getItem(this.adminKey);return e?JSON.parse(e):null}getAdminToken(){return localStorage.getItem(this.tokenKey)}logoutAdmin(){localStorage.removeItem(this.adminKey),localStorage.removeItem(this.tokenKey),console.log("Admin logged out successfully.")}static{this.\u0275fac=function(o){return new(o||t)(C(T))}}static{this.\u0275prov=w({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Z(t,m){t&1&&(i(0,"p"),a(1,"Email is required"),n())}function $(t,m){t&1&&(i(0,"p"),a(1,"Enter a valid email"),n())}function ee(t,m){if(t&1&&(i(0,"div",17),c(1,Z,2,0,"p",18)(2,$,2,0,"p",18),n()),t&2){let e=g();s(),l("ngIf",e.f.Email.errors==null?null:e.f.Email.errors.required),s(),l("ngIf",e.f.Email.errors==null?null:e.f.Email.errors.email)}}function te(t,m){t&1&&(i(0,"p"),a(1,"Password is required"),n())}function ie(t,m){if(t&1&&(i(0,"div",17),c(1,te,2,0,"p",18),n()),t&2){let e=g();s(),l("ngIf",e.f.password.errors==null?null:e.f.password.errors.required)}}function ne(t,m){t&1&&(i(0,"div",19),d(1,"div",20),n())}function oe(t,m){t&1&&(i(0,"div",21)(1,"div",22)(2,"div",23),d(3,"img",24),n(),i(4,"h4",25),a(5,"Login Successful"),n(),i(6,"h4")(7,"a",26),a(8,"Delivery agents"),n()()()())}function re(t,m){if(t&1){let e=P();i(0,"div",27)(1,"div",28)(2,"div",29),M(),i(3,"svg",30),d(4,"path",31),n()(),E(),i(5,"h4"),a(6,"Login Failed"),n(),i(7,"p"),a(8),n(),i(9,"button",32),h("click",function(){S(e);let r=g();return k(r.showErrorPopup=!1)}),a(10,"Close"),n()()()}if(t&2){let e=g();s(8),L(e.errorMessage)}}var ve=(()=>{class t{constructor(e,o,r,f,Q,W){this.adminservice=e,this.route=o,this.fb=r,this.registerservice=f,this.router=Q,this.activated=W,this.isloading=!1,this.showpopup=!1,this.errorMessage="",this.showErrorPopup=!1}ngOnInit(){this.adminform=this.fb.group({Email:["",[u.required,u.email]],password:["",[u.required]]})}get f(){return this.adminform.controls}onSubmit(){if(this.errorMessage="",this.showErrorPopup=!1,this.adminform.valid){let e=this.adminform.value,o={email:e.Email,password:e.password};this.isloading=!0,this.adminservice.adminLogin(o).subscribe({next:r=>{this.isloading=!1,this.showpopup=!0,setTimeout(()=>{this.showpopup=!1,this.router.navigate(["/delivery"])},3e3)},error:r=>{this.isloading=!1,this.errorMessage=r?.error?.message||"Admin Login failed Please Try Again Later",this.showErrorPopup=!0,console.log(r)}})}this.adminform.reset()}static{this.\u0275fac=function(o){return new(o||t)(p(J),p(v),p(G),p(H),p(v),p(j))}}static{this.\u0275cmp=y({type:t,selectors:[["app-admin-login"]],standalone:!0,features:[I],decls:25,vars:6,consts:[[1,"back"],["autoplay","","muted","","loop","","playsinline",""],["src","assets/videos/video-admin.mp4","type","video/mp4"],[1,"login-container"],[1,"login-card"],[3,"ngSubmit","formGroup"],[1,"mb-2"],["for","username",1,"form-label","text-start","d-block","text-dark","h4"],["type","email","id","username","formControlName","Email","placeholder","username",1,"form-control"],["class","error",4,"ngIf"],[1,"password-container","mt-3"],["for","password",1,"form-label","text-start","d-block","text-dark","h4"],["type","password","id","password","formControlName","password","placeholder","password",1,"form-control"],["type","submit",1,"login-button"],["class","spinner-overlay",4,"ngIf"],["class","popup-overlay",4,"ngIf"],["class","error-overlay",4,"ngIf"],[1,"error"],[4,"ngIf"],[1,"spinner-overlay"],[1,"spinner"],[1,"popup-overlay"],[1,"popup-card"],[1,"popup-icon"],["src","assets/images/check.png","alt","imgsri",2,"width","40px","height","40px"],[1,"h3","fs-1"],["routerLink","/delivery",1,"btn","btn-primary"],[1,"error-overlay"],[1,"error-card"],[1,"error-icon"],["xmlns","http://www.w3.org/2000/svg","width","40","height","40","fill","red","viewBox","0 0 16 16",1,"bi","bi-x-circle"],["d","M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"],[1,"btn","btn-danger","w-25","mt-3",3,"click"]],template:function(o,r){o&1&&(i(0,"div",0)(1,"video",1),d(2,"source",2),n(),i(3,"div",3)(4,"div",4)(5,"h2"),a(6,"Admin Login"),n(),i(7,"form",5),h("ngSubmit",function(){return r.onSubmit()}),i(8,"div",6)(9,"label",7),a(10,"Username:"),n(),d(11,"input",8),c(12,ee,3,2,"div",9),n(),i(13,"div",10)(14,"label",11),a(15,"Password:"),n(),d(16,"input",12),c(17,ie,2,1,"div",9),n(),d(18,"br")(19,"br"),i(20,"button",13),a(21,"Login"),n()()()()(),c(22,ne,2,0,"div",14)(23,oe,9,0,"div",15)(24,re,11,1,"div",16)),o&2&&(s(7),l("formGroup",r.adminform),s(5),l("ngIf",r.f.Email.touched&&r.f.Email.invalid),s(5),l("ngIf",r.f.password.touched&&r.f.password.invalid),s(5),l("ngIf",r.isloading),s(),l("ngIf",r.showpopup),s(),l("ngIf",r.showErrorPopup))},dependencies:[z,U,R,F,K,V,q,D,N,O,A],styles:[".login-container[_ngcontent-%COMP%]{margin-top:20px;position:relative;z-index:2;display:flex;justify-content:center;align-items:center;height:100vh;background-color:#eae6e61b}.login-card[_ngcontent-%COMP%]{background-color:#f3faf9;padding:50px 60px;position:relative;border-radius:12px;box-shadow:0 0 12px #00000026;text-align:center;width:450px}h2[_ngcontent-%COMP%]{margin-bottom:25px;font-size:32px;font-weight:700;color:#000;font-family:Tahoma,Verdana,sans-serif}.login-card[_ngcontent-%COMP%]   .back-arrow[_ngcontent-%COMP%]{position:absolute;top:16px;left:20px;margin:0;font-size:24px;color:#000}.input-field[_ngcontent-%COMP%]{width:100%;padding:14px;margin-bottom:20px;border:1px solid #ddd;border-radius:6px;outline:none;font-size:16px;background-color:#3e3e3e}.password-container[_ngcontent-%COMP%]{position:relative}.toggle-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:14px;cursor:pointer;color:#ddd;background-color:#ddd}.links[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:25px;font-size:16px}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{flex:1;text-align:center;background-color:#3e3e3e;color:#fff;padding:6px 0;border-radius:4px;text-decoration:none;font-size:14px;margin:0 6px;transition:background-color .3s ease;max-height:50px}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#00000072;color:#000}.login-button[_ngcontent-%COMP%]{width:100%;padding:14px;background-color:#c73b34;border:none;border-radius:6px;color:#fff;font-size:18px;cursor:pointer}.login-button[_ngcontent-%COMP%]:hover{background-color:#ec271c}.back[_ngcontent-%COMP%]{position:relative;width:100%;height:100vh;overflow:hidden}.back[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;min-width:100%;min-height:100%;transform:translate(-50%,-50%);object-fit:cover;z-index:1}.popup-overlay[_ngcontent-%COMP%], .error-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#2e2e2e97;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-card[_ngcontent-%COMP%], .error-card[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:12px;box-shadow:0 0 12px #00000040;text-align:center;max-width:700px;width:90%}.popup-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:10px}.spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#151515bb;display:flex;justify-content:center;align-items:center;z-index:999}.spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:6px solid #ccc;border-top-color:#dc3545;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})}}return t})();export{ve as AdminLoginComponent};
