import './polyfills.server.mjs';
import{a as h}from"./chunk-6YWVIACV.mjs";import{Ac as u,b as a,q as s,t as c,w as i,wb as l}from"./chunk-CGQJEPQN.mjs";var o=class{};var n="user",I=(()=>{class r{constructor(t,e){this.http=t,this.router=e,this.url=h.userlogin,this.userSubject=new a(this.getUserFromLocalStorage()),this.userObservable=this.userSubject.asObservable()}get currentUser(){return this.userSubject.value}register(t){return this.http.post(this.url,t).pipe(s({next:e=>{e.isAdmin=e.role==="ADMIN",this.setUserToLocalStorage(e),this.userSubject.next(e),console.log(`User registered successfully: ${e.id}`)},error:e=>{e.error instanceof ProgressEvent?console.error("Registration failed: Backend unreachable or network error",e):console.error("Registration failed:",e.error)}}))}login(t){return this.http.post(`${this.url}login`,t).pipe(s({next:e=>{localStorage.setItem("UserData",JSON.stringify(e)),this.currentiser=e,this.setUserToLocalStorage(e),this.userSubject.next(e)},error:e=>{console.log(e.error,"Login Failed")}}))}getUserFromLocalStorage(){let t=localStorage.getItem(n);return t?JSON.parse(t):new o}setUserToLocalStorage(t){localStorage.setItem(n,JSON.stringify(t))}logout(){this.userSubject.next(new o),localStorage.removeItem(n),console.log("User has logged out successfully.")}changePassword(t){let g={Authorization:`Bearer ${localStorage.getItem("token")}`};return this.http.post("http://localhost:8800/api/users/{id}/change-password",t,{headers:g})}get currentUserValue(){if(!this.currentiser){let t=localStorage.getItem("user");t&&(this.currentiser=JSON.parse(t))}return this.currentUser}profile(t,e){return this.http.put(`${this.url}${t}`,e)}static{this.\u0275fac=function(e){return new(e||r)(i(l),i(u))}}static{this.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{I as a};
